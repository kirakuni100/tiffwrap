include(ExternalProject)

externalproject_add(
    doctest
    URL https://github.com/onqtam/doctest/archive/2.3.8.zip
    PREFIX ${PROJECT_BINARY_DIR}/doctest
    UPDATE_COMMAND    ""
    CONFIGURE_COMMAND ""
    BUILD_COMMAND     ""
    INSTALL_COMMAND   ""
    LOG_DOWNLOAD  ON
    LOG_CONFIGURE ON
    LOG_BUILD     ON
)

externalproject_get_property(doctest source_dir)
set(DOCTEST_INC_DIR ${source_dir}/doctest)

add_library(doctest_main OBJECT src/doctest_main.cc)
add_dependencies(doctest_main doctest)

set_target_properties(
    doctest_main PROPERTIES
    CXX_STANDARD 17
    CXX_EXTENSIONS OFF
)

target_compile_features(
    doctest_main PRIVATE
    cxx_std_11
)

target_include_directories(
    doctest_main PRIVATE
    ${DOCTEST_INC_DIR}
)

